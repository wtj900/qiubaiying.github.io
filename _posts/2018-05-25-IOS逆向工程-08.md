---
layout:     post
title:      逆向工程
subtitle:   类与方法
date:       2018-05-25
author:     JT
header-img: img/post-bg-ios9-web.jpg
catalog: true
tags:
    - 逆向
---

# LLDB常用命令

## 打印值、修改值、调用方法

#### `p`、`po` 打印值

`p` 和 `po` 的区别在于使用 `po` 只会输出对应的值，而 `p` 则会返回值的类型以及命令结果的引用名。

```
(lldb) p width
(CGFloat) $10 = 70
(lldb) po width
70
```

# 类与方法

在AppDelegate中打断点，执行lldb命令查看

```
(lldb) p self
(AppDelegate *) $0 = 0x0000600003e46380     // 表名self是一个指针
(lldb) p sizeof(self)
(unsigned long) $1 = 8                      // 指针的大小
(lldb) p sizeof(void *)                     // void * 代表指针
(unsigned long) $2 = 8
(lldb) p (int)class_getInstanceSize([AppDelegate class])
(int) $0 = 24                               // 返回一个实例的大小


(lldb) p self
(AppDelegate *) $1 = 0x000060000325a500
(lldb) memory read/3wg $1                   // 打印内存分布
0x60000325a500: 0x000000010535fd08 0x0000000000000000
0x60000325a510: 0x00007fe78c406b90
(lldb) p (Class)0x000000010535fd08          // 对象第一个内容是自己的class,近似isa，arm64架构下不一样
(Class) $4 = AppDelegate
(lldb) po 0x00007fe78c406b90
<UIWindow: 0x7fe78c406b90; frame = (0 0; 414 896); hidden = YES; gestureRecognizers = <NSArray: 0x600003c5b270>; layer = <UIWindowLayer: 0x60000325b2c0>>



```





![](https://wtj900.github.io/img/reverse/ios文件系统.png)

# 数据存储

* plist文件

像memgraph这样的二进制plist文件查看方式，可以转换为plist文件

`plutil -convert xml1 /Users/li/Desktop/ALIHA_20190419.tlog -o /Users/li/Desktop/ALIHA_20190419.plist`

* User	Defaults
* Data base
* Keychain  Github上[Keychain-Dumpper](https://github.com/ptoomey3/Keychain-Dumper)把二进制文件上传到越狱设备的根目录下，并确保可访问

```
# 登录
ssh root@localhost -p 2222

# 将keychain_dumper拷贝到越狱设备的根目录下
scp -P 2222 keychain_dumper root@localhost:/

# 确保文件有权限
chmod +x ./keychain_dumper

# 确保文件数据库可读
chmod +r /private/var/Keychains/keychain-2.db

# 执行命令可查看到隐私数据
./keychain_dumper
```




